<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Humble Choice Countdown</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: system-ui, sans-serif;
            background-color: #282c34;
            color: #f0f0f0;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

            body::before {
                content: "";
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: repeating-linear-gradient( 45deg, #2a2d35, #2a2d35 4px, transparent 4px, transparent 35px );
                pointer-events: none;
                z-index: -1;
            }

        .container {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            height: 100vh;
        }

        .top-half {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 0 5%;
        }

        .bottom-half {
            flex: 1;
            background-color: #1f2229;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: 10px 5px 10px;
            position: relative; /* for positioning disclaimer at bottom */
        }

        h1 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            margin-bottom: 1rem;
            letter-spacing: 1px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        #countdown {
            font-size: clamp(1.5rem, 6vw, 3rem);
            margin-bottom: 1rem;
            word-break: break-word;
            color: #cb272c;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.5);
        }

        #endtime {
            color: #aaa;
            font-size: clamp(1rem, 4vw, 1.5rem);
            line-height: 1.4;
            display: inline-block;
            padding: 5px 10px;
            border-radius: 6px;
            text-align: center;
            margin-bottom: 10px;
        }

        .games-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            width: 100%;
        }

        .game-card {
            flex: 0 0 auto;
            width: 80px;
            text-align: center;
            font-size: 0.75rem;
            color: #f0f0f0;
        }

            .game-card img {
                width: 100%;
                border-radius: 4px;
                margin-bottom: 4px;
                object-fit: cover;
            }

        .disclaimer {
            color: #888;
            font-size: 0.8rem;
            text-align: center;
            position: absolute;
            bottom: 10px;
        }

        @media (max-width: 600px) {
            .game-card {
                width: 60px;
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-half">
            <h1>Next Humble Choice Reveal</h1>
            <div id="countdown" aria-live="polite">Loading...</div>
            <div id="endtime"></div>
        </div>
        <div class="bottom-half">
            <div class="games-grid" id="gamesGrid">
                <!-- 9 Placeholder game cards -->
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+1" alt="Game 1">
                    <div class="game-title">Game 1</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+2" alt="Game 2">
                    <div class="game-title">Game 2</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+3" alt="Game 3">
                    <div class="game-title">Game 3</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+4" alt="Game 4">
                    <div class="game-title">Game 4</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+5" alt="Game 5">
                    <div class="game-title">Game 5</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+6" alt="Game 6">
                    <div class="game-title">Game 6</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+7" alt="Game 7">
                    <div class="game-title">Game 7</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+8" alt="Game 8">
                    <div class="game-title">Game 8</div>
                </div>
                <div class="game-card">
                    <img src="https://via.placeholder.com/80x80?text=Game+9" alt="Game 9">
                    <div class="game-title">Game 9</div>
                </div>
            </div>
            <p class="disclaimer">
                This is an unofficial countdown and is not affiliated with Humble Bundle.
            </p>
        </div>
    </div>

    <script>
        // Countdown JS (unchanged)
        function firstTuesdayPT(year, month) {
            let d = new Date(Date.UTC(year, month, 1, 17, 0, 0));
            while (new Intl.DateTimeFormat('en-US', { timeZone: 'America/Los_Angeles', weekday: 'short' }).format(d) !== 'Tue') {
                d.setUTCDate(d.getUTCDate() + 1);
            }
            return d;
        }

        function getNextEvent() {
            const now = new Date();
            let event = firstTuesdayPT(now.getUTCFullYear(), now.getUTCMonth());

            const nowPT = new Date(now.toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));
            const eventPT = new Date(event.toLocaleString('en-US', { timeZone: 'America/Los_Angeles' }));

            if (nowPT > eventPT) {
                const nextMonth = now.getUTCMonth() === 11 ? 0 : now.getUTCMonth() + 1;
                const nextYear = now.getUTCMonth() === 11 ? now.getUTCFullYear() + 1 : now.getUTCFullYear();
                event = firstTuesdayPT(nextYear, nextMonth);
            }

            return event;
        }

        let targetUTC = getNextEvent();
        const countdownEl = document.getElementById('countdown');
        const endtimeEl = document.getElementById('endtime');

        function updateCountdown() {
            const nowUTC = new Date();
            const diff = targetUTC - nowUTC;
            if (diff <= 0) {
                countdownEl.textContent = "Humble Choice is live!";
                return;
            }
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const mins = Math.floor((diff / (1000 * 60)) % 60);
            const secs = Math.floor((diff / 1000) % 60);
            countdownEl.textContent = `${days}d ${hours}h ${mins}m ${secs}s`;
        }

        const localTime = new Date(targetUTC.toLocaleString());
        const weekday = localTime.toLocaleDateString(undefined, { weekday: 'long' });
        const formattedDate = localTime.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
        const formattedTime = localTime.toLocaleTimeString(undefined, { hour: 'numeric', minute: '2-digit', hour12: true });
        const tzName = Intl.DateTimeFormat().resolvedOptions().timeZone;

        endtimeEl.innerHTML = `${weekday}, ${formattedDate} at ${formattedTime}<br>(${tzName})`;

        updateCountdown();
        setInterval(updateCountdown, 1000);
    </script>
</body>
</html>
